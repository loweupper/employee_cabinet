# Quick Reference: Docker Migrations

## ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
```bash
# –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç!
docker exec -it employees_app alembic revision --autogenerate -m "" upgrade head
```

## ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

#### 1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ (—Å–∞–º–∞—è —á–∞—Å—Ç–∞—è –∫–æ–º–∞–Ω–¥–∞)
```bash
./migrate.sh upgrade
```
–ò–ª–∏ –≤—Ä—É—á–Ω—É—é:
```bash
docker exec -it employees_app sh -c "cd /app && alembic upgrade head"
```

#### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é
```bash
./migrate.sh current
```

#### 3. –û—Ç–∫–∞—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –º–∏–≥—Ä–∞—Ü–∏—é
```bash
./migrate.sh downgrade -1
```

#### 4. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é
```bash
./migrate.sh autogenerate "–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
```

## üÜò –ü–æ–º–æ—â—å
```bash
./migrate.sh help
```

## üìö –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [DOCKER_MIGRATION_GUIDE.md](./DOCKER_MIGRATION_GUIDE.md) - –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- [MIGRATION_GUIDE.md](./MIGRATION_GUIDE.md) - –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–∏–≥—Ä–∞—Ü–∏—è—Ö

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω?
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–º—è
docker ps

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è
export DOCKER_CONTAINER_NAME=your_container_name
./migrate.sh upgrade
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è?
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
docker exec employees_app env | grep POSTGRES

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ë–î –∑–∞–ø—É—â–µ–Ω–∞
docker ps | grep postgres
```

### –ù—É–∂–Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è?
```bash
docker exec employees_app pg_dump -U postgres -d your_db > backup_$(date +%Y%m%d).sql
```

## üéØ –¢–∏–ø–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose up -d

# 2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
./migrate.sh upgrade

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
./migrate.sh current
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –Ω–æ–≤—ã–º–∏ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏
```bash
# 1. –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
./backup.sh  # –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ pg_dump

# 2. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
docker-compose down

# 3. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ (git pull)
git pull

# 4. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose build

# 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å
docker-compose up -d

# 6. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
./migrate.sh upgrade
```

### –û—Ç–∫–∞—Ç –ø–æ—Å–ª–µ –Ω–µ—É–¥–∞—á–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏
```bash
# 1. –û—Ç–∫–∞—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
./migrate.sh downgrade -1

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é
./migrate.sh current

# 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –±—ç–∫–∞–ø–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
docker exec -i postgres_container psql -U user -d db < backup.sql
```
