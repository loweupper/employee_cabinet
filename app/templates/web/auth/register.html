<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <title>Регистрация</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        .fade-in {
            animation: fadeIn 0.6s ease-out forwards;
            opacity: 0;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .glow {
            transition: box-shadow 0.3s ease;
        }

        .glow:focus {
            box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.3);
        }
    </style>
</head>

<body class="bg-gradient-to-br from-gray-100 to-gray-200 min-h-screen flex items-center justify-center">

    <div class="w-full max-w-md bg-white shadow-xl rounded-2xl p-8 fade-in">

        <h2 class="text-3xl font-semibold text-gray-800 text-center mb-6">
            Создать аккаунт ✨
        </h2>

        <!-- ✅ БЛОК ОШИБКИ -->
        {% if error %}
        <div class="bg-red-50 border-l-4 border-red-500 text-red-700 p-4 mb-6 rounded-lg fade-in" role="alert">
            <div class="flex items-start">
                <svg class="w-6 h-6 mr-3 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd"
                        d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"
                        clip-rule="evenodd" />
                </svg>
                <div>
                    <p class="font-semibold">Ошибка регистрации</p>
                    <p class="text-sm">{{ error }}</p>
                </div>
            </div>
        </div>
        {% endif %}

        <form method="post" action="/api/v1/auth/register" class="space-y-6">

            <div>
                <label class="block text-gray-700 mb-1">Email</label>
                <input type="email" name="email" required value="{{ email or '' }}"
                    class="w-full px-4 py-3 rounded-xl border border-gray-300 glow focus:border-emerald-500"
                    placeholder="you@example.com">
            </div>

            <div>
                <label class="block text-gray-700 mb-1">Пароль</label>
                <input type="password" name="password" required id="password"
                    class="w-full px-4 py-3 rounded-xl border border-gray-300 glow focus:border-emerald-500"
                    placeholder="Минимум 8 символов">

                <div id="password-hints" class="text-xs mt-2 space-y-1">
                    <p id="hint-length" class="text-gray-400">✗ Минимум 8 символов</p>
                    <p id="hint-upper" class="text-gray-400">✗ Заглавная буква (A-Z)</p>
                    <p id="hint-lower" class="text-gray-400">✗ Строчная буква (a-z)</p>
                    <p id="hint-digit" class="text-gray-400">✗ Цифра (0-9)</p>
                    <p id="hint-special" class="text-gray-400">✗ Спецсимвол (@$!%*?&)</p>
                </div>
            </div>
            <div>
                <label class="block text-gray-700 mb-1">Имя</label>
                <input type="text" name="first_name" value="{{ first_name or '' }}"
                    class="w-full px-4 py-3 rounded-xl border border-gray-300 glow focus:border-emerald-500"
                    placeholder="Иван">
            </div>

            <div>
                <label class="block text-gray-700 mb-1">Фамилия</label>
                <input type="text" name="last_name" value="{{ last_name or '' }}"
                    class="w-full px-4 py-3 rounded-xl border border-gray-300 glow focus:border-emerald-500"
                    placeholder="Иванов">
            </div>

            <button type="submit"
                class="w-full py-3 rounded-xl bg-emerald-600 text-white font-medium hover:bg-emerald-700 transition-all shadow-md hover:shadow-lg">
                Зарегистрироваться
            </button>
        </form>

        <div class="text-center mt-6">
            <a href="/api/v1/auth/login-page" class="text-emerald-600 hover:underline">
                Уже есть аккаунт? Войти
            </a>
        </div>

    </div>
    <script>
        document.getElementById('password').addEventListener('input', function (e) {
            const pwd = e.target.value;

            // Проверки
            const checks = {
                length: pwd.length >= 8,
                upper: /[A-Z]/.test(pwd),
                lower: /[a-z]/.test(pwd),
                digit: /[0-9]/.test(pwd),
                special: /[@$!%*?&]/.test(pwd)
            };

            // Обновляем UI
            for (const [key, valid] of Object.entries(checks)) {
                const el = document.getElementById('hint-' + key);
                if (valid) {
                    el.className = 'text-green-600';
                    el.textContent = el.textContent.replace('✗', '✓');
                } else {
                    el.className = 'text-gray-400';
                    el.textContent = el.textContent.replace('✓', '✗');
                }
            }
        });
    </script>
</body>

</html>